<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
           fx:controller="com.emsi.subtracker.controllers.StatsController"
           stylesheets="@../styles/style.css"
           styleClass="main-container">
    
    <top>
        <HBox spacing="20" alignment="CENTER_LEFT" styleClass="navbar">
             <padding>
                <Insets top="15" right="30" bottom="15" left="30"/>
            </padding>
            <Label text="SUB TRACKER" styleClass="brand-label"/>
            <HBox HBox.hgrow="ALWAYS" /> <!-- Spacer -->
            <Button text="DASHBOARD" styleClass="nav-button" onAction="#handleGoToDashboard"/>
            <Button text="STATISTICS" styleClass="nav-button-active"/>
            <Button text="LOGOUT" styleClass="nav-button-danger" onAction="#handleLogout"/>
        </HBox>
    </top>

    <center>
        <VBox spacing="25" styleClass="content-area">
            <padding>
                <Insets top="30" right="40" bottom="30" left="40"/>
            </padding>

            <VBox>
                 <Label text="Financial Analysis" styleClass="page-title"/>
                 <Label text="Visual insights into your spending habits." styleClass="page-subtitle"/>
            </VBox>
            
            <HBox spacing="20" alignment="CENTER_LEFT">
                 <!-- Total Card -->
                 <VBox styleClass="card" alignment="CENTER_LEFT" minWidth="250" spacing="5">
                     <padding>
                         <Insets top="20" right="20" bottom="20" left="20"/>
                     </padding>
                     <Label text="Monthly Total" styleClass="page-subtitle"/>
                     <Label fx:id="totalLabel" text="0.00 MAD" style="-fx-font-size: 36px; -fx-font-weight: 900; -fx-text-fill: linear-gradient(to right, #00e676, #1de9b6);"/>
                 </VBox>
            </HBox>

            <HBox spacing="20" VBox.vgrow="ALWAYS">
                <!-- Pie Chart -->
                <VBox styleClass="table-container" HBox.hgrow="ALWAYS" spacing="10">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    <Label text="BY CATEGORY" style="-fx-font-weight:bold; -fx-text-fill:#888;"/>
                    <PieChart fx:id="pieChart" style="-fx-background-color: transparent;" legendSide="RIGHT"/>
                </VBox>
                
                <!-- Bar Chart -->
                <VBox styleClass="table-container" HBox.hgrow="ALWAYS" spacing="10">
                    <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
                    <Label text="MONTHLY FORECAST" style="-fx-font-weight:bold; -fx-text-fill:#888;"/>
                    <BarChart fx:id="barChart" style="-fx-background-color: transparent;" legendVisible="false">
                        <xAxis>
                            <CategoryAxis label="Month" />
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Cost" />
                        </yAxis>
                    </BarChart>
                </VBox>
            </HBox>
        </VBox>
    </center>

</BorderPane>
